---
title: Commerce kanālu finanšu integrācijas apskats
description: Šajā tēmā ir sniegts apskats par finanšu integrācijas iespējām, kas ir pieejamas programmā Dynamics 365 Commerce.
author: josaw
manager: annbe
ms.date: 02/01/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailFunctionalityProfile, RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.search.region: Global
ms.search.industry: Retail
ms.author: v-kikozl
ms.search.validFrom: 2019-1-16
ms.dyn365.ops.version: 10
ms.openlocfilehash: d2455f775fcf41bbcb1388b2e8053ede8512335d
ms.sourcegitcommit: 52ba8d3e6af72df5dab6c04b9684a61454d353ad
ms.translationtype: HT
ms.contentlocale: lv-LV
ms.lasthandoff: 05/26/2020
ms.locfileid: "3403219"
---
# <a name="overview-of-fiscal-integration-for-commerce-channels"></a><span data-ttu-id="6f74a-103">Commerce kanālu finanšu integrācijas apskats</span><span class="sxs-lookup"><span data-stu-id="6f74a-103">Overview of fiscal integration for Commerce channels</span></span>

[!include [banner](../includes/banner.md)]

## <a name="introduction"></a><span data-ttu-id="6f74a-104">Ievads</span><span class="sxs-lookup"><span data-stu-id="6f74a-104">Introduction</span></span>

<span data-ttu-id="6f74a-105">Šajā tēmā ir sniegts apskats par finanšu integrācijas iespējām, kas ir pieejamas programmā Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="6f74a-105">This topic is an overview of the fiscal integration capabilities that are available in Dynamics 365 Commerce.</span></span> <span data-ttu-id="6f74a-106">Finanšu integrācija ietver integrāciju ar dažādām finanšu ierīcēm un pakalpojumiem, kas nodrošina tirdzniecības pārdošanas darbību finanšu reģistrāciju saskaņā ar vietējiem likumiem par nodokļiem, kuru mērķis ir novērst ar nodokļiem saistītu krāpniecību mazumtirdzniecības nozarē.</span><span class="sxs-lookup"><span data-stu-id="6f74a-106">Fiscal integration includes integration with various fiscal devices and services that enable fiscal registration of sales in accordance with local fiscal laws that are aimed at preventing tax fraud in the retail industry.</span></span> <span data-ttu-id="6f74a-107">Tālāk ir norādīti daži tipiski scenāriji, kuros var izmantot finanšu integrāciju.</span><span class="sxs-lookup"><span data-stu-id="6f74a-107">Here are some typical scenarios that can be covered by using fiscal integration:</span></span>

- <span data-ttu-id="6f74a-108">Reģistrējiet tirdzniecības pārdošanas darbību finanšu ierīcē, kas ir savienota ar programmu Point of Sale (POS), piemēram fiskālo printeri, un izdrukājiet debitoram paredzētu finanšu dokumentu.</span><span class="sxs-lookup"><span data-stu-id="6f74a-108">Register a sale on a fiscal device that is connected to point of sale (POS), such as a fiscal printer, and print a fiscal receipt for the customer.</span></span>
- <span data-ttu-id="6f74a-109">Drošā veidā iesniedziet ar programmā Retail POS veiktajām pārdošanas un atgriešanas darbībām saistīto informāciju ārējā tīmekļa pakalpojumā, kura darbību nodrošina nodokļu iestāde.</span><span class="sxs-lookup"><span data-stu-id="6f74a-109">Securely submit information that is related to sales and returns that are completed in Retail POS to an external web-service that is operated by the tax authority.</span></span>
- <span data-ttu-id="6f74a-110">Palīdziet nodrošināt pārdošanas transakciju datu nemaināmību, izmantojot ciparparakstus.</span><span class="sxs-lookup"><span data-stu-id="6f74a-110">Help guarantee inalterability of sales transaction data through digital signatures.</span></span>

<span data-ttu-id="6f74a-111">Finanšu integrācijas funkcionalitāte ir struktūra, kas nodrošina kopēju risinājumu tālākai programmas Retail POS un finanšu ierīču un pakalpojumu integrācijas izstrādei un pielāgošanai.</span><span class="sxs-lookup"><span data-stu-id="6f74a-111">The fiscal integration functionality is a framework that provides a common solution for further development and customization of the integration between Retail POS and fiscal devices and services.</span></span> <span data-ttu-id="6f74a-112">Funkcionalitātē ir ietverti arī finanšu integrācijas paraugi, kas atbalsta pamata scenārijus noteiktās valstīs vai reģionos un darbojas ar noteiktām finanšu ierīcēm vai pakalpojumiem.</span><span class="sxs-lookup"><span data-stu-id="6f74a-112">The functionality also includes fiscal integration samples that support basic scenarios for specific countries or regions, and that work with specific fiscal devices or services.</span></span> <span data-ttu-id="6f74a-113">Finanšu integrācijas paraugu veido vairāki programmas Commerce komponentu paplašinājumi, un tas ir iekļauts programmatūras izstrādes komplektā (SDK).</span><span class="sxs-lookup"><span data-stu-id="6f74a-113">A fiscal integration sample consists of several extensions of Commerce components and is included in the software development kit (SDK).</span></span> <span data-ttu-id="6f74a-114">Plašāku informāciju par finanšu integrācijas paraugiem skatiet tēmā [Finanšu integrācijas paraugi programmā Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span><span class="sxs-lookup"><span data-stu-id="6f74a-114">For more information about the fiscal integration samples, see [Fiscal integration samples in the Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span></span> <span data-ttu-id="6f74a-115">Papildinformāciju par to, kā instalēt un izmantot komplektu Retail SDK, skatiet rakstā [Retail programmatūras izstrādes komplekta (SDK) arhitektūra](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6f74a-115">For information about how to install and use the Retail SDK, see [Retail software development kit (SDK) architecture](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span></span>

<span data-ttu-id="6f74a-116">Lai nodrošinātu tādu scenāriju atbalstu, kurus neatbalstīta finanšu integrācijas paraugs, integrētu programmu Retail POS ar citām finanšu ierīcēm vai pakalpojumiem, vai izpildītu citās valstīs vai reģionos spēkā esošās prasības, ir jāpaplašina kāds no esošajiem finanšu integrācijas paraugiem vai jāizveido jauns paraugs, kā piemēru izmantojot esošu paraugu.</span><span class="sxs-lookup"><span data-stu-id="6f74a-116">To support other scenarios that aren't supported by a fiscal integration sample, to integrate Retail POS with other fiscal devices or services, or to cover requirements of other countries or regions, you must either extend an existing fiscal integration sample or create a new sample by using an existing sample as an example.</span></span>

## <a name="fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices"></a><span data-ttu-id="6f74a-117">Finanšu reģistrācijas process un finanšu integrācijas paraugi finanšu ierīcēm</span><span class="sxs-lookup"><span data-stu-id="6f74a-117">Fiscal registration process and fiscal integration samples for fiscal devices</span></span>

<span data-ttu-id="6f74a-118">Finanšu reģistrācijas process programmā Retail POS var sastāvēt no vienas vai vairākām darbībām.</span><span class="sxs-lookup"><span data-stu-id="6f74a-118">A fiscal registration process in Retail POS can consist of one or more steps.</span></span> <span data-ttu-id="6f74a-119">Katra darbība ietver noteiktu transakciju vai notikumu finanšu reģistrāciju vienā finanšu ierīcē vai pakalpojumā.</span><span class="sxs-lookup"><span data-stu-id="6f74a-119">Each step involves fiscal registration of specific transactions or events in one fiscal device or service.</span></span> <span data-ttu-id="6f74a-120">Finanšu reģistrācijai finanšu ierīcē, kas ir savienota ar aparatūras staciju, tiek izmantoti tālāk norādītie risinājuma komponenti.</span><span class="sxs-lookup"><span data-stu-id="6f74a-120">The following solution components participate in the fiscal registration in a fiscal device that is connected to a Hardware station:</span></span>

- <span data-ttu-id="6f74a-121">**Commerce runtime (CRT) paplašinājums** — šis komponents nodrošina transakcijas/notikuma datu serializēšanu formātā, kas tiek izmantots arī mijiedarbībai ar finanšu ierīci, no finanšu ierīces saņemto atbilžu parsēšanu un atbilžu saglabāšanu kanāla datu bāzē.</span><span class="sxs-lookup"><span data-stu-id="6f74a-121">**Commerce runtime (CRT) extension** – This component serializes transaction/event data in the format that is also used for interaction with the fiscal device, parses responses from the fiscal device, and stores the responses in the channel database.</span></span> <span data-ttu-id="6f74a-122">Šis paplašinājums nosaka arī konkrētās transakcijas un notikumus, kas ir jāreģistrē.</span><span class="sxs-lookup"><span data-stu-id="6f74a-122">The extension also defines the specific transactions and events that must be registered.</span></span> <span data-ttu-id="6f74a-123">Šis komponents bieži tiek saukts par *finanšu dokumentu nodrošinātāju*.</span><span class="sxs-lookup"><span data-stu-id="6f74a-123">This component is often referred to as a *fiscal document provider*.</span></span>
- <span data-ttu-id="6f74a-124">**Aparatūras stacijas paplašinājums** – šis komponents nodrošina saziņas ar finanšu ierīci inicializāciju, pieprasījumu un tiešu komandu sūtīšanu uz finanšu ierīci, pamatojoties uz transakcijas/notikuma datiem, kas ir izgūti no finanšu dokumenta, un atbilžu saņemšanu no finanšu ierīces.</span><span class="sxs-lookup"><span data-stu-id="6f74a-124">**Hardware station extension** – This component initializes the communication with the fiscal device, sends requests and direct commands to the fiscal device based on the transaction/event data that is extracted from the fiscal document, and receives responses from the fiscal device.</span></span> <span data-ttu-id="6f74a-125">Šis komponents bieži tiek saukts par *finanšu savienotāju*.</span><span class="sxs-lookup"><span data-stu-id="6f74a-125">This component is often referred to as a *fiscal connector*.</span></span>

<span data-ttu-id="6f74a-126">Finanšu ierīces finanšu integrācijas paraugā ir ietverti CRT un aparatūras stacijas paplašinājumi attiecīgi finanšu dokumentu nodrošinātājam un finanšu savienotājam.</span><span class="sxs-lookup"><span data-stu-id="6f74a-126">A fiscal integration sample for a fiscal device contains the CRT and Hardware station extensions for a fiscal document provider and a fiscal connector, respectively.</span></span> <span data-ttu-id="6f74a-127">Tajā ir ietvertas arī tālāk norādītās komponentu konfigurācijas.</span><span class="sxs-lookup"><span data-stu-id="6f74a-127">It also contains the following component configurations:</span></span>

- <span data-ttu-id="6f74a-128">**Finanšu dokumentu nodrošinātāja konfigurācija** — šajā konfigurācijā ir definēta izvades metodi un finanšu dokumentu formāts.</span><span class="sxs-lookup"><span data-stu-id="6f74a-128">**Fiscal document provider configuration** – This configuration defines an output method and a format for fiscal documents.</span></span> <span data-ttu-id="6f74a-129">Tajā ir ietverta arī nodokļus un maksājuma metožu datu kartēšana, lai padarītu no programmas Retail POS saņemtos datus saderīgus ar finanšu ierīces programmaparatūrā iepriekš definētajām vērtībām.</span><span class="sxs-lookup"><span data-stu-id="6f74a-129">It also contains a data mapping for taxes and payment methods, to make data from Retail POS compatible with the values that are predefined in the fiscal device firmware.</span></span>
- <span data-ttu-id="6f74a-130">**Finanšu savienotāja konfigurācija** — šajā konfigurācijā ir definēta fiziskā saziņa ar konkrēto finanšu ierīci.</span><span class="sxs-lookup"><span data-stu-id="6f74a-130">**Fiscal connector configuration** – This configuration defines the physical communication with the specific fiscal device.</span></span>

<span data-ttu-id="6f74a-131">Noteiktas POS kases sistēmas finanšu reģistrācijas process tiek definēts, izmantojot atbilstošo iestatījumu POS funkcionalitātes profilā.</span><span class="sxs-lookup"><span data-stu-id="6f74a-131">A fiscal registration process for a specific POS register is defined by a corresponding setting in the POS functionality profile.</span></span> <span data-ttu-id="6f74a-132">Papildinformāciju par to, kā konfigurēt finanšu reģistrācijas procesu, augšupielādēt finanšu dokumentu nodrošinātāju un finanšu savienotāju konfigurācijas un mainīt to parametrus, redzēt rakstā [Finanšu reģistrācijas procesa iestatīšana](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span><span class="sxs-lookup"><span data-stu-id="6f74a-132">For more details about how to configure a fiscal registration process, upload fiscal document provider and fiscal connector configurations, and change their parameters, see [Set up a fiscal registration process](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span></span>

<span data-ttu-id="6f74a-133">Tālāk sniegtajā piemērā ir aprakstīta tipiska finanšu reģistrācijas izpildes plūsma finanšu ierīcei.</span><span class="sxs-lookup"><span data-stu-id="6f74a-133">The following example shows a typical fiscal registration execution flow for a fiscal device.</span></span> <span data-ttu-id="6f74a-134">Plūsma sākas ar notikumu POS sistēmā (piemēram, pārdošanas transakcijas pabeigšanu), un tajā ir ietverta tālāk norādītā darbību secība.</span><span class="sxs-lookup"><span data-stu-id="6f74a-134">The flow starts with an event in the POS (for example, finalization of a sales transaction) and implements the following sequence of steps:</span></span>

1. <span data-ttu-id="6f74a-135">POS sistēma pieprasa finanšu dokumentu no programmas CRT.</span><span class="sxs-lookup"><span data-stu-id="6f74a-135">The POS requests a fiscal document from CRT.</span></span>
2. <span data-ttu-id="6f74a-136">CRT nosaka, vai pašreizējam notikumam ir nepieciešama finanšu reģistrācija.</span><span class="sxs-lookup"><span data-stu-id="6f74a-136">CRT determines whether the current event requires fiscal registration.</span></span>
3. <span data-ttu-id="6f74a-137">Pamatojoties uz finanšu reģistrācijas procesa iestatījumiem, programma CRT nosaka finanšu savienotāju un atbilstošo finanšu dokumentu nodrošinātāju, kas ir jāizmanto finanšu reģistrācijai.</span><span class="sxs-lookup"><span data-stu-id="6f74a-137">Based on the fiscal registration process settings, CRT identifies a fiscal connector and corresponding fiscal document provider to use for the fiscal registration.</span></span>
4. <span data-ttu-id="6f74a-138">CRT izpilda finanšu dokumentu nodrošinātāju, kas ģenerē finanšu dokumentu (piemēram, XML formāta dokumentu), kurš atbilst transakcijai vai notikumam.</span><span class="sxs-lookup"><span data-stu-id="6f74a-138">CRT runs the fiscal document provider that generates a fiscal document (for example, an XML document) that represents the transaction or event.</span></span>
5. <span data-ttu-id="6f74a-139">POS sistēma nosūta programmas CRT sagatavoto finanšu dokumentu uz aparatūras staciju.</span><span class="sxs-lookup"><span data-stu-id="6f74a-139">The POS sends the fiscal document that CRT prepares to a Hardware station.</span></span>
6. <span data-ttu-id="6f74a-140">Aparatūras stacija izpilda finanšu savienotāju, kas apstrādā finanšu dokumentu un pārsūta to uz finanšu ierīci vai pakalpojumu.</span><span class="sxs-lookup"><span data-stu-id="6f74a-140">The Hardware station runs the fiscal connector that processes the fiscal document and communicates it to the fiscal device or service.</span></span>
7. <span data-ttu-id="6f74a-141">POS sistēma analizē no finanšu ierīces vai pakalpojuma saņemto atbildi, lai noteiktu, vai finanšu reģistrācija ir bijusi veiksmīga.</span><span class="sxs-lookup"><span data-stu-id="6f74a-141">The POS analyzes the response from the fiscal device or service to determine whether the fiscal registration was successful.</span></span>
8. <span data-ttu-id="6f74a-142">CRT saglabā atbildi kanāla datu bāzē.</span><span class="sxs-lookup"><span data-stu-id="6f74a-142">CRT saves the response to the channel database.</span></span>

<span data-ttu-id="6f74a-143">![Risinājumu shēma](media/emea-fiscal-integration-solution.png "Risinājumu shēma")</span><span class="sxs-lookup"><span data-stu-id="6f74a-143">![Solution schema](media/emea-fiscal-integration-solution.png "Solution schema")</span></span>

## <a name="error-handling"></a><span data-ttu-id="6f74a-144">Kļūdu apstrāde</span><span class="sxs-lookup"><span data-stu-id="6f74a-144">Error handling</span></span>

<span data-ttu-id="6f74a-145">Finanšu integrācijas struktūra nodrošina tālāk norādītās opcijas kļūmju apstrādei finanšu reģistrācijas laikā.</span><span class="sxs-lookup"><span data-stu-id="6f74a-145">The fiscal integration framework provides the following options to handle failures during fiscal registration:</span></span>

- <span data-ttu-id="6f74a-146">**Mēģināt vēlreiz** — operatori var izmantot šo opciju gadījumā, ja kļūmi var ātri novērst un var atkārtoti izpildīt finanšu reģistrāciju.</span><span class="sxs-lookup"><span data-stu-id="6f74a-146">**Retry** – Operators can use this option when the failure can be resolved quickly, and the fiscal registration can be rerun.</span></span> <span data-ttu-id="6f74a-147">Piemēram, šo opciju var izmantot gadījumā, ja finanšu ierīce nav pievienota vai fiskālajā printerī ir beidzies vai iesprūdis papīrs.</span><span class="sxs-lookup"><span data-stu-id="6f74a-147">For example, this option can be used when the fiscal device isn't connected, the fiscal printer is out of paper, or there is a paper jam in the fiscal printer.</span></span>
- <span data-ttu-id="6f74a-148">**Atcelt** — šī opcija sniedz operatoriem iespēju atlikt pašreizējās transakcijas vai notikuma finanšu reģistrāciju, ja tā neizdodas.</span><span class="sxs-lookup"><span data-stu-id="6f74a-148">**Cancel** – This option lets operators postpone the fiscal registration of the current transaction or event if it fails.</span></span> <span data-ttu-id="6f74a-149">Pēc reģistrācijas atlikšanas operators var turpināt strādāt ar POS sistēmu un veikt jebkuru operāciju, kam nav nepieciešama finanšu reģistrācija.</span><span class="sxs-lookup"><span data-stu-id="6f74a-149">After the registration is postponed, the operator can continue to work on the POS and can complete any operation that the fiscal registration isn't required for.</span></span> <span data-ttu-id="6f74a-150">Kad POS sistēmā notiek notikums, kam ir nepieciešama finanšu reģistrācija (piemēram, tiek atvērta jauna transakcija), tiek automātiski parādīts kļūdu apstrādes dialoglodziņš, kurā operatoram tiek paziņots, ka iepriekšējā transakcija netika pareizi reģistrēta, un tiek norādītas kļūdu apstrādes iespējas.</span><span class="sxs-lookup"><span data-stu-id="6f74a-150">When any event that requires the fiscal registration occurs in the POS (for example, a new transaction is opened), the error handling dialog box automatically appears to notify the operator that the previous transaction wasn't correctly registered and to provide the error handling options.</span></span>
- <span data-ttu-id="6f74a-151">**Izlaist** — operatori var izmantot šo opciju gadījumā, ja finanšu reģistrāciju var izlaist noteiktos apstākļos un POS sistēmā var turpināt veikt parastās operācijas.</span><span class="sxs-lookup"><span data-stu-id="6f74a-151">**Skip** – Operators can use this option when the fiscal registration can be omitted under specific conditions and regular operations can be continued on the POS.</span></span> <span data-ttu-id="6f74a-152">Piemēram, šo opciju var izmantot gadījumā, ja pārdošanas transakciju, kuras finanšu reģistrācija neizdevās, var reģistrēt īpašā papīra žurnālā.</span><span class="sxs-lookup"><span data-stu-id="6f74a-152">For example, this option can be used when a sales transaction that the fiscal registration failed for can be registered in a special paper journal.</span></span>
- <span data-ttu-id="6f74a-153">**Atzīmēt kā reģistrētu** — operatori var izmantot šo opciju gadījumā, ja transakcija ir reģistrēta finanšu ierīcē (piemēram, ir izdrukāts finanšu dokuments), taču, saglabājot finanšu atbildi kanāla datu bāzē, ir radusies kļūme.</span><span class="sxs-lookup"><span data-stu-id="6f74a-153">**Mark as registered** – Operators can use this option when the transaction was actually registered in the fiscal device (for example, a fiscal receipt was printed), but a failure occurred when the fiscal response was being saved to the channel database.</span></span>

> [!NOTE]
> <span data-ttu-id="6f74a-154">Opcijas **Izlaist** un **Atzīmēt kā reģistrētu** pirms lietošanas ir jāaktivizē finanšu reģistrācijas procesa ietvaros.</span><span class="sxs-lookup"><span data-stu-id="6f74a-154">The **Skip** and **Mark as registered** options must be activated in the fiscal registration process before they are used.</span></span> <span data-ttu-id="6f74a-155">Turklāt operatoriem ir jāpiešķir atbilstošās atļaujas.</span><span class="sxs-lookup"><span data-stu-id="6f74a-155">In addition, corresponding permissions must be granted to operators.</span></span>

<span data-ttu-id="6f74a-156">Izmantojot opcijas **Izlaist** un **Atzīmēt kā reģistrētu**, tiek iespējoti informācijas kodi, lai reģistrētu noteiktu informāciju par kļūmi, piemēram, kļūmes iemeslu vai pamatojumu finanšu reģistrācijai vai transakcijas reģistrācijas atzīmēšanai.</span><span class="sxs-lookup"><span data-stu-id="6f74a-156">The **Skip** and **Mark as registered** options enable info codes to capture some specific information about the failure, such as the reason for the failure or a justification for skipping the fiscal registration or marking the transaction as registered.</span></span> <span data-ttu-id="6f74a-157">Papildinformāciju par to, kā iestatīt kļūdu apstrādes parametrus, skatiet rakstā [Kļūdu apstrādes iestatījumu veikšana](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="6f74a-157">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="optional-fiscal-registration"></a><span data-ttu-id="6f74a-158">Neobligāta finanšu reģistrācija</span><span class="sxs-lookup"><span data-stu-id="6f74a-158">Optional fiscal registration</span></span>

<span data-ttu-id="6f74a-159">Finanšu reģistrācija var būt obligāta dažām operācijām, bet neobligāta citām.</span><span class="sxs-lookup"><span data-stu-id="6f74a-159">Fiscal registration might be mandatory for some operations but optional for others.</span></span> <span data-ttu-id="6f74a-160">Piemēram, regulāras pārdošanas un atgriešanas finanšu reģistrācija var būt obligāta, bet ar klienta iemaksām saistītu operāciju finanšu reģistrācija var būt neobligāta.</span><span class="sxs-lookup"><span data-stu-id="6f74a-160">For example, the fiscal registration of regular sales and returns might be mandatory, but the fiscal registration of operations that are related to customer deposits might be optional.</span></span> <span data-ttu-id="6f74a-161">Šajā gadījumā finanšu reģistrācijas neveikšana pārdošanas darījumam bloķē turpmāku pārdošanu, bet finanšu reģistrācijas neveikšana attiecībā uz klienta iemaksu nebloķē turpmāku pārdošanu.</span><span class="sxs-lookup"><span data-stu-id="6f74a-161">In this case, failure to complete the fiscal registration of a sale should block further sales, but failure to complete the fiscal registration of a customer deposit should not block further sales.</span></span> <span data-ttu-id="6f74a-162">Lai nodalītu obligātas un neobligātas operācijas, ieteicams tās apstrādāt, izmantojot dažādus dokumentu nodrošinātājus un iestatīt atsevišķus soļus finanšu reģistrācijas procesā šiem nodrošinātājiem.</span><span class="sxs-lookup"><span data-stu-id="6f74a-162">To distinguish mandatory and optional operations, we recommend that you handle them through different document providers, and that you set up separate steps in the fiscal registration process for those providers.</span></span> <span data-ttu-id="6f74a-163">Parametram **Kļūdas gadījumā turpināt** ir jābūt iespējotam visiem soļiem, kas saistīti ar papildu finanšu reģistrāciju.</span><span class="sxs-lookup"><span data-stu-id="6f74a-163">The **Continue on error** parameter should be enabled for any step that is related to optional fiscal registration.</span></span> <span data-ttu-id="6f74a-164">Papildinformāciju par to, kā iestatīt kļūdu apstrādes parametrus, skatiet rakstā [Kļūdu apstrādes iestatījumu veikšana](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="6f74a-164">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="manually-running-fiscal-registration"></a><span data-ttu-id="6f74a-165">Manuāla finanšu reģistrācijas izpilde</span><span class="sxs-lookup"><span data-stu-id="6f74a-165">Manually running fiscal registration</span></span>

<span data-ttu-id="6f74a-166">Ja darījuma vai notikuma finanšu reģistrācija ir atlikta pēc kļūmes (piemēram, ja operators atlasīja **Atcelt** kļūdu apstrādes dialoglodziņā), varat manuāli atkārtoti izpildīt finanšu reģistrāciju, izsaucot atbilstošu operāciju.</span><span class="sxs-lookup"><span data-stu-id="6f74a-166">If the fiscal registration of a transaction or event has been postponed after a failure (for example, if the operator selected **Cancel** in the error handling dialog box), you can manually rerun the fiscal registration by invoking a corresponding operation.</span></span> <span data-ttu-id="6f74a-167">Papildinformāciju skatiet tēmā [Atliktas finanšu reģistrācijas manuālas izpildes iespējošana](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span><span class="sxs-lookup"><span data-stu-id="6f74a-167">For more details, see [Enable manual execution of postponed fiscal registration](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span></span>

### <a name="fiscal-registration-health-check"></a><span data-ttu-id="6f74a-168">Finanšu reģistrācijas darbspējas pārbaude</span><span class="sxs-lookup"><span data-stu-id="6f74a-168">Fiscal registration health check</span></span>

<span data-ttu-id="6f74a-169">Finanšu reģistrācijas darbspējas pārbaudes procedūra pārbauda finanšu ierīces vai pakalpojuma pieejamību noteiktu notikumu gadījumā.</span><span class="sxs-lookup"><span data-stu-id="6f74a-169">The health check procedure for fiscal registrations verifies the availability of the fiscal device or service when specific events occur.</span></span> <span data-ttu-id="6f74a-170">Ja pašlaik nevar izpildīt finanšu reģistrāciju, operators saņem iepriekšēju paziņojumu.</span><span class="sxs-lookup"><span data-stu-id="6f74a-170">If the fiscal registration can't currently be completed, the operator is notified in advance.</span></span>

<span data-ttu-id="6f74a-171">POS veic darbspējas pārbaudi šādu notikumu gadījumā:</span><span class="sxs-lookup"><span data-stu-id="6f74a-171">The POS runs the health check when the following events occur:</span></span>

- <span data-ttu-id="6f74a-172">Tiek atvērts jauns darījums.</span><span class="sxs-lookup"><span data-stu-id="6f74a-172">A new transaction is opened.</span></span>
- <span data-ttu-id="6f74a-173">Tiek veikta aizturēta darījuma atsaukšana.</span><span class="sxs-lookup"><span data-stu-id="6f74a-173">A suspended transaction is recalled.</span></span>
- <span data-ttu-id="6f74a-174">Tiek pabeigts pārdošanas vai atgriešanas darījums.</span><span class="sxs-lookup"><span data-stu-id="6f74a-174">A sales or return transaction is finalized.</span></span>

<span data-ttu-id="6f74a-175">Ja darbspējas pārbaude neizdodas, POS rāda darbspējas pārbaudes dialoglodziņu.</span><span class="sxs-lookup"><span data-stu-id="6f74a-175">If the health check fails, the POS shows the health check dialog box.</span></span> <span data-ttu-id="6f74a-176">Minētajā dialoglodziņā ir pieejamas šādas pogas:</span><span class="sxs-lookup"><span data-stu-id="6f74a-176">This dialog box provides the following buttons:</span></span>

- <span data-ttu-id="6f74a-177">**Labi** — šī poga ļauj operatoram ignorēt darbspējas pārbaudes kļūdu un turpināt, lai apstrādātu darījumu.</span><span class="sxs-lookup"><span data-stu-id="6f74a-177">**OK** – This button lets the operator ignore a health check error and continue to process the operation.</span></span> <span data-ttu-id="6f74a-178">Operatori var atlasīt šo pogu tikai tad, ja tiem ir iespējota atļauja **Atļaut izlaist darbspējas pārbaudes kļūdu**.</span><span class="sxs-lookup"><span data-stu-id="6f74a-178">Operators can select this button only if the **Allow skip health check error** permission is enabled for them.</span></span>
- <span data-ttu-id="6f74a-179">**Atcelt** — ja operators izvēlas šo pogu, POS atceļ pēdējo darbību (piemēram, krājums nav pievienots jaunam darījumam).</span><span class="sxs-lookup"><span data-stu-id="6f74a-179">**Cancel** – If the operator selects this button, the POS cancels the last action (for example, an item isn't added to a new transaction).</span></span>

> [!NOTE]
> <span data-ttu-id="6f74a-180">Darbspējas pārbaude tiek izpildīta tikai tad, ja pašreizējai operācijai obligāti jāveic finanšu reģistrācija un ja parametrs **Kļūdas gadījumā turpināt** ir atspējots pašreizējam finanšu reģistrācijas procesa solim.</span><span class="sxs-lookup"><span data-stu-id="6f74a-180">The health check is run only if the current operation requires fiscal registration, and if  the **Continue on error** parameter is disabled for the current step of the fiscal registration process.</span></span> <span data-ttu-id="6f74a-181">Plašāku informāciju skatiet tēmā [Kļūdu apstrādes iestatījumu veikšana](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="6f74a-181">For more details, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

## <a name="storing-fiscal-response-in-fiscal-transaction"></a><span data-ttu-id="6f74a-182">Finanšu atbildes saglabāšana finanšu transakcijā</span><span class="sxs-lookup"><span data-stu-id="6f74a-182">Storing fiscal response in fiscal transaction</span></span>

<span data-ttu-id="6f74a-183">Ja transakcijas vai notikuma finanšu reģistrācija ir veiksmīga, kanāla datu bāzē tiek izveidota finanšu transakcija, kas tiek saistīta ar sākotnējo transakciju vai notikumu.</span><span class="sxs-lookup"><span data-stu-id="6f74a-183">When fiscal registration of a transaction or event is successful, a fiscal transaction is created in the channel database and linked to the original transaction or event.</span></span> <span data-ttu-id="6f74a-184">Līdzīgi gadījumā, ja neveiksmīgai finanšu reģistrācijai tiek atlasīta opcija **izlaist** vai **Atzīmēt kā reģistrētu**, šī informācija tiek saglabāta finanšu transakcijā.</span><span class="sxs-lookup"><span data-stu-id="6f74a-184">Similarly, if the **Skip** or **Mark as registered** option is selected for a failed fiscal registration, this information is stored in a fiscal transaction.</span></span> <span data-ttu-id="6f74a-185">Finanšu transakcijā ir ietverta finanšu ierīces vai pakalpojuma finanšu atbilde.</span><span class="sxs-lookup"><span data-stu-id="6f74a-185">A fiscal transaction holds the fiscal response of the fiscal device or service.</span></span> <span data-ttu-id="6f74a-186">Ja finanšu reģistrācijas process sastāv no vairākām darbībām, katrai procesa darbībai, kuras rezultāts ir veiksmīga vai neveiksmīga reģistrācija, tiek izveidota finanšu transakcija.</span><span class="sxs-lookup"><span data-stu-id="6f74a-186">If the fiscal registration process consists of several steps, a fiscal transaction is created for each step of the process that resulted in a successful or failed registration.</span></span>

<span data-ttu-id="6f74a-187">Finanšu transakcijas kopā ar transakcijām tiek pārsūtītas uz Headquarters, izmantojot funkciju *P darbs*.</span><span class="sxs-lookup"><span data-stu-id="6f74a-187">Fiscal transactions are transferred to Headquarters by the *P-job*, together with transactions.</span></span> <span data-ttu-id="6f74a-188">Lapas **Veikalu transakcijas** kopsavilkuma cilnē **Finanšu transakcijas** varat skatīt finanšu transakcijas, kas ir saistītas ar  transakcijām.</span><span class="sxs-lookup"><span data-stu-id="6f74a-188">On the **Fiscal transactions** FastTab of the **Store transactions** page, you can view the fiscal transactions that are linked to transactions.</span></span>

<span data-ttu-id="6f74a-189">Finanšu transakcijā ir saglabāta tālāk norādītā detalizētā informācija.</span><span class="sxs-lookup"><span data-stu-id="6f74a-189">A fiscal transaction stores the following details:</span></span>

- <span data-ttu-id="6f74a-190">Detalizēta informācija par finanšu reģistrācijas procesu (par procesu, savienotāju grupu, savienotāju utt.).</span><span class="sxs-lookup"><span data-stu-id="6f74a-190">Fiscal registration process details (process, connector group, connector, and so on).</span></span> <span data-ttu-id="6f74a-191">Turklāt laukā **Kases sistēmas numurs** tiek glabāts finanšu ierīces sērijas numurs, ja šī informācija ir ietverta finanšu atbildē.</span><span class="sxs-lookup"><span data-stu-id="6f74a-191">It also stores the serial number of the fiscal device in the **Register number** field, if this information is included in the fiscal response.</span></span>
- <span data-ttu-id="6f74a-192">Finanšu reģistrācijas statuss: **Pabeigta**, ja reģistrācija ir bijusi veiksmīga; **Izlaista**, ja operators neveiksmīgai reģistrācijai ir atlasījis opciju **Izlaist**; vai **Atzīmēta kā reģistrēta**, ja operators ir atlasījis opciju **Atzīmēt kā reģistrētu**.</span><span class="sxs-lookup"><span data-stu-id="6f74a-192">The status of the fiscal registration: **Completed** for successful registration, **Skipped** if the operator selected the **Skip** option for a failed registration, or **Marked as registered** if the operator selected the **Mark as registered** option.</span></span>
- <span data-ttu-id="6f74a-193">Informācijas koda transakcijas, kas ir saistītas ar atlasīto finanšu transakciju.</span><span class="sxs-lookup"><span data-stu-id="6f74a-193">Info code transactions that are related to a selected fiscal transaction.</span></span> <span data-ttu-id="6f74a-194">Lai skatītu informācijas koda transakcijas, kopsavilkuma cilnē **Finanšu transakcijas** atlasiet finanšu transakciju, kuras statuss ir **Izlaista** vai **Atzīmēta kā reģistrēta**, un pēc tam atlasiet vienumu **Informācijas koda transakcijas**.</span><span class="sxs-lookup"><span data-stu-id="6f74a-194">To view the info code transactions, on the **Fiscal transactions** FastTab, select a fiscal transaction that has a status of **Skipped** or **Marked as registered**, and then select **Info code transactions**.</span></span>

## <a name="fiscal-texts-for-discounts"></a><span data-ttu-id="6f74a-195">Atlaižu finanšu teksts</span><span class="sxs-lookup"><span data-stu-id="6f74a-195">Fiscal texts for discounts</span></span>

<span data-ttu-id="6f74a-196">Dažās valstīs vai reģionos ir spēkā īpašas prasības attiecībā uz papildu tekstu, kas ir jādrukā finanšu dokumentos gadījumā, ja tiek lietotas dažāda veida atlaides.</span><span class="sxs-lookup"><span data-stu-id="6f74a-196">Some countries or regions have special requirements about additional texts that must be printed on fiscal receipts when different kinds of discounts are applied.</span></span> <span data-ttu-id="6f74a-197">Finanšu integrācijas funkcionalitāte sniedz iespēju iestatīt atlaidei īpašu tekstu, kas tiek drukāts pēc atlaides rindas finanšu dokumentā.</span><span class="sxs-lookup"><span data-stu-id="6f74a-197">The fiscal integration functionality lets you set up a special text for a discount that is printed after a discount line on a fiscal receipt.</span></span> <span data-ttu-id="6f74a-198">Manuālām atlaidēm varat konfigurēt finanšu tekstu informācijas kodam, kas POS funkcionalitātes profilā ir norādīts kā informācijas kods **Preces atlaide**.</span><span class="sxs-lookup"><span data-stu-id="6f74a-198">For manual discounts, you can configure a fiscal text for the info code that is specified as the **Product discount** info code in the POS functionality profile.</span></span> <span data-ttu-id="6f74a-199">Papildinformāciju par to, kā iestatīt atlaižu finanšu tekstu, skatiet rakstā [Atlaižu finanšu teksta iestatīšana](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span><span class="sxs-lookup"><span data-stu-id="6f74a-199">For more details about how to set up fiscal texts for discounts, see [Set up fiscal texts for discounts](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span></span>

## <a name="printing-fiscal-x-and-fiscal-z-reports"></a><span data-ttu-id="6f74a-200">Finanšu X un Z pārskatu drukāšana</span><span class="sxs-lookup"><span data-stu-id="6f74a-200">Printing fiscal X and fiscal Z reports</span></span>

<span data-ttu-id="6f74a-201">Finanšu integrācijas funkcionalitāte atbalsta tādu dienas beigu pārskatu ģenerēšanu, kas ir raksturīgi integrētajai finanšu ierīcei vai pakalpojumam.</span><span class="sxs-lookup"><span data-stu-id="6f74a-201">Fiscal integration functionality supports generation of end-of-day statements that are specific to the integrated fiscal device or service:</span></span>

- <span data-ttu-id="6f74a-202">POS ekrāna izkārtojumam ir jāpievieno jaunas pogas, kas nodrošina atbilstošo operāciju izpildi.</span><span class="sxs-lookup"><span data-stu-id="6f74a-202">New buttons that run corresponding operations should be added to the POS screen layout.</span></span> <span data-ttu-id="6f74a-203">Papildinformāciju skatiet rakstā [Finanšu X/Z pārskatu iestatīšana POS sistēmā](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span><span class="sxs-lookup"><span data-stu-id="6f74a-203">For more details, see [Set up fiscal X/Z reports from the POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span></span>
- <span data-ttu-id="6f74a-204">Finanšu integrācijas paraugā šīs operācijas ir jāsaskaņo ar atbilstošajām finanšu ierīces operācijām.</span><span class="sxs-lookup"><span data-stu-id="6f74a-204">In the fiscal integration sample, these operations should be matched to the corresponding operations of the fiscal device.</span></span>

## <a name="fiscal-integration-samples-in-the-retail-sdk"></a><span data-ttu-id="6f74a-205">Finanšu integrācijas paraugi komplektā Retail SDK</span><span class="sxs-lookup"><span data-stu-id="6f74a-205">Fiscal integration samples in the Retail SDK</span></span>

<span data-ttu-id="6f74a-206">Pašlaik komplektā Retail SDK ir pieejami tālāk norādītie finanšu integrācijas paraugi.</span><span class="sxs-lookup"><span data-stu-id="6f74a-206">The following fiscal integration samples are currently available in the Retail SDK:</span></span>

- [<span data-ttu-id="6f74a-207">Fiskālā printera integrācijas piemērs Itālijai</span><span class="sxs-lookup"><span data-stu-id="6f74a-207">Fiscal printer integration sample for Italy</span></span>](emea-ita-fpi-sample.md)
- [<span data-ttu-id="6f74a-208">Fiskālā printera integrācijas piemērs Polijai</span><span class="sxs-lookup"><span data-stu-id="6f74a-208">Fiscal printer integration sample for Poland</span></span>](emea-pol-fpi-sample.md)
- [<span data-ttu-id="6f74a-209">Fiskālās reģistrācijas pakalpojuma integrācijas paraugs Austrijai</span><span class="sxs-lookup"><span data-stu-id="6f74a-209">Fiscal registration service integration sample for Austria</span></span>](emea-aut-fi-sample.md)
- [<span data-ttu-id="6f74a-210">Fiskālās reģistrācijas pakalpojuma integrācijas paraugs Čehijas Republikai</span><span class="sxs-lookup"><span data-stu-id="6f74a-210">Fiscal registration service integration sample for Czech Republic</span></span>](emea-cze-fi-sample.md)
- [<span data-ttu-id="6f74a-211">Vadības ierīces integrācijas paraugs izmantošanai Zviedrijā</span><span class="sxs-lookup"><span data-stu-id="6f74a-211">Control unit integration sample for Sweden</span></span>](./emea-swe-fi-sample.md)
- [<span data-ttu-id="6f74a-212">Fiskālās reģistrācijas pakalpojuma integrācijas paraugs Vācijai</span><span class="sxs-lookup"><span data-stu-id="6f74a-212">Fiscal registration service integration sample for Germany</span></span>](./emea-deu-fi-sample.md)

<span data-ttu-id="6f74a-213">Komplektā Retail SDK ir pieejama arī tālāk norādītā fiskālās integrācijas funkcionalitāte, taču pašlaik tai netiek izmantota finanšu integrācijas struktūra.</span><span class="sxs-lookup"><span data-stu-id="6f74a-213">The following fiscal integration functionality is also available in the Retail SDK but doesn't currently take advantage of the fiscal integration framework.</span></span> <span data-ttu-id="6f74a-214">Nākamajos atjauninājumos ir plānota šīs funkcionalitātes migrēšana uz finanšu integrācijas struktūru.</span><span class="sxs-lookup"><span data-stu-id="6f74a-214">Migration of this functionality to the fiscal integration framework is planned for later updates.</span></span>


- [<span data-ttu-id="6f74a-215">Ciparparaksts izmantošanai Francijā</span><span class="sxs-lookup"><span data-stu-id="6f74a-215">Digital signature for France</span></span>](emea-fra-cash-registers.md)
- [<span data-ttu-id="6f74a-216">Ciparparaksts izmantošanai Norvēģijā</span><span class="sxs-lookup"><span data-stu-id="6f74a-216">Digital signature for Norway</span></span>](emea-nor-cash-registers.md)

<span data-ttu-id="6f74a-217">Šāda mantotās fiskālās integrācijas funkcionalitāte, kas ir pieejama Retail SDK, neizmanto finanšu integrācijas struktūru un līdz ar vēlākiem atjauninājumiem būs novecojusi.</span><span class="sxs-lookup"><span data-stu-id="6f74a-217">The following legacy fiscal integration functionality that is available in Retail SDK does not use the fiscal integration framework and will be deprecated in later updates:</span></span>

- [<span data-ttu-id="6f74a-218">Vadības ierīces integrācijas paraugs izmantošanai Zviedrijā (mantots)</span><span class="sxs-lookup"><span data-stu-id="6f74a-218">Control unit integration sample for Sweden (legacy)</span></span>](./retail-sdk-control-unit-sample.md)
